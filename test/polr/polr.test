# name: test/polr/polr.test
# description: Run POLR test queries
# group: [polr]

statement ok
CREATE TABLE table_a AS SELECT * FROM read_csv_auto('test/polr/data/table_a.csv')

statement ok
CREATE TABLE table_b AS SELECT * FROM read_csv_auto('test/polr/data/table_b.csv')

statement ok
CREATE TABLE table_c AS SELECT * FROM read_csv_auto('test/polr/data/table_c.csv')

# row-wise
query IIIIII
SELECT * FROM table_a JOIN table_b ON table_a.a_a = table_b.b_a JOIN table_c ON table_a.a_b = table_c.c_b
----
990	3990	990	2990	0	3990
991	3991	991	2991	1	3991
992	3992	992	2992	2	3992
993	3993	993	2993	3	3993
994	3994	994	2994	4	3994
995	3995	995	2995	5	3995
996	3996	996	2996	6	3996
997	3997	997	2997	7	3997
998	3998	998	2998	8	3998
999	3999	999	2999	9	3999
990	3990	990	1990	0	3990
991	3991	991	1991	1	3991
992	3992	992	1992	2	3992
993	3993	993	1993	3	3993
994	3994	994	1994	4	3994
995	3995	995	1995	5	3995
996	3996	996	1996	6	3996
997	3997	997	1997	7	3997
998	3998	998	1998	8	3998
999	3999	999	1999	9	3999

statement ok
SET disabled_optimizers TO 'join_order'

# row-wise
query IIIIII
SELECT * FROM table_a JOIN table_b ON table_a.a_a = table_b.b_a JOIN table_c ON table_a.a_b = table_c.c_b
----
990	3990	990	2990	0	3990
991	3991	991	2991	1	3991
992	3992	992	2992	2	3992
993	3993	993	2993	3	3993
994	3994	994	2994	4	3994
995	3995	995	2995	5	3995
996	3996	996	2996	6	3996
997	3997	997	2997	7	3997
998	3998	998	2998	8	3998
999	3999	999	2999	9	3999
990	3990	990	1990	0	3990
991	3991	991	1991	1	3991
992	3992	992	1992	2	3992
993	3993	993	1993	3	3993
994	3994	994	1994	4	3994
995	3995	995	1995	5	3995
996	3996	996	1996	6	3996
997	3997	997	1997	7	3997
998	3998	998	1998	8	3998
999	3999	999	1999	9	3999

# row-wise (custom join order)
query IIIIII
SELECT * FROM table_a JOIN table_c ON table_a.a_b = table_c.c_b JOIN table_b ON table_a.a_a = table_b.b_a
----
990	3990	0	3990	990	2990
991	3991	1	3991	991	2991
992	3992	2	3992	992	2992
993	3993	3	3993	993	2993
994	3994	4	3994	994	2994
995	3995	5	3995	995	2995
996	3996	6	3996	996	2996
997	3997	7	3997	997	2997
998	3998	8	3998	998	2998
999	3999	9	3999	999	2999
990	3990	0	3990	990	1990
991	3991	1	3991	991	1991
992	3992	2	3992	992	1992
993	3993	3	3993	993	1993
994	3994	4	3994	994	1994
995	3995	5	3995	995	1995
996	3996	6	3996	996	1996
997	3997	7	3997	997	1997
998	3998	8	3998	998	1998
999	3999	9	3999	999	1999

statement ok
PRAGMA enable_polr

# row-wise
query IIIIII
SELECT * FROM table_a JOIN table_b ON table_a.a_a = table_b.b_a JOIN table_c ON table_a.a_b = table_c.c_b
----
990	3990	990	2990	0	3990
991	3991	991	2991	1	3991
992	3992	992	2992	2	3992
993	3993	993	2993	3	3993
994	3994	994	2994	4	3994
995	3995	995	2995	5	3995
996	3996	996	2996	6	3996
997	3997	997	2997	7	3997
998	3998	998	2998	8	3998
999	3999	999	2999	9	3999
990	3990	990	1990	0	3990
991	3991	991	1991	1	3991
992	3992	992	1992	2	3992
993	3993	993	1993	3	3993
994	3994	994	1994	4	3994
995	3995	995	1995	5	3995
996	3996	996	1996	6	3996
997	3997	997	1997	7	3997
998	3998	998	1998	8	3998
999	3999	999	1999	9	3999
